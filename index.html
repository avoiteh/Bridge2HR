<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Messenger</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript">
var gbData;

function getMessage(){
	$.ajax({
		type: "GET",
		dataType: "json",
		url: "message.php",
		success: function(msg){
			update(msg);
		}
	});
}

function update(msg){
	gbData=msg;
	showGB();
}

function showGB(){
	$('#message').prepend(showGBnode(gbData));
}

function showGBnode(node){
	console.log(node);
	var res='';
	for(var i in node){
		console.log(node[i].child);
		if(node[i].child.length>0){
			var subnode=showGBnode(node[i].child);
		}else{
			var subnode='';
		}
		res+='<div style="margin-left:20px; border:#000 1px solid;"><p>'+node[i].uname+'</p><p>'+node[i].mess+'</p><p>'+node[i].date+'</p>'+subnode+'</div>';
	}
	return res;
}



</script>
</head>
<body>
<input type="button" value="Новое сообщение" onClick="getMessage();" />
<div id="message" class="container"></div>
</body> 
</html>